---
title: "Assessing Bridge Conditions in New York State: The Impact of Age, Municipality, and Structural Deficiencies"
subtitle: "My subtitle if needed"
author: 
  - Ariel Xing
thanks: "Code and data are available at: [https://github.com/Jiaqi-Xing/NYS_Bridge_Condition_Analysis](https://github.com/Jiaqi-Xing/NYS_Bridge_Condition_Analysis)."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
toc: true 
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(arrow)
library(knitr)
bridge_data <- read_parquet("../data/02-analysis_data/cleaned_bridge_condition_data.parquet")
```


# Introduction

Overview paragraph

Estimand paragraph

Results paragraph

Why it matters paragraph

Telegraphing paragraph: The remainder of this paper is structured as follows. @sec-data....






# Data {#sec-data}

## Overview

The dataset used in this analysis, titled “New_York_Bridges_2016”, was accessed from the Data And Story Library (DASL) [@dasl_data_2016], which archives historical data originally compiled by the New York State Open Data platform [@ny_open_data_2020]. The original dataset includes contributions from county-level data provided by the New York State Department of Transportation (NYSDOT) [@county_data].

This dataset was chosen over the updated 2020 version from New York State Open Data due to the change in how bridge condition data is recorded. In the 2016 dataset, the condition variable is a continuous variable measured on a seven-point scale (1 = "Deficient Condition" to 7 = "Good Condition"). However, in the 2020 dataset, NYSDOT replaced this scale with a binary Poor/OK variable, recorded as Poor01 (1 = Poor, 0 = OK). This change limits the analytical potential of the dataset, as the binary variable lacks the granularity required for linear regression that relies on continuous variables to detect nuanced trends or incremental differences. By using the 2016 dataset, this study retains the detailed numerical condition ratings, enabling to analysis impact of factors such as age, location, and owners on bridge conditions.

The raw dataset contains 17,502 rows and 13 columns, providing structural, geographical, and condition-related data on bridges across New York State. After data cleaning, four key variables were selected for analysis: the response variable “Condition” and three predictor variables, “AgeAtInspection”, “Located_Municipality”, and “Owner_Group”. The variables “Condition” and “AgeAtInspection” are numeric and were directly retained from the raw data. The categorical variables “Located_Municipality” and “Owner_Group” were newly constructed by categorizing the original variables “Municipality” and “Owner”, respectively.


To conduct the analysis for this paper, we utilized the statistical programming language R [@citeR]. The workflow was supported by several packages, including tidyverse [@tidyverse] for data cleaning and manipulation, arrow [@arrow] for efficient data storage and retrieval, validate [@validate] for data testing and validation, knitr[@knitr] for creating tables and ggplot2 [@ggplot2] for creating visualizations.


## Measurement
	
In New York State, bridge inspectors from the State Department of Transportation (NYSDOT) conduct evaluations of non-toll bridges every two years to ensure their safety and structural integrity. Their assessments are performed on a span-by-span basis, meaning that each section of the bridge between its supporting points is inspected individually. For every bridge, inspectors examine up to 47 structural elements, including 25 span-specific components such as the deck, beams, and supports. Each component is assigned a condition score, ranging from 1 (severely deficient) to 7 (new or excellent condition), which reflects its structural health at the time of inspection. Inspectors also note any defects, such as cracks, corrosion, or wear, and document associated quantities, such as the length, area, or number of affected elements, to capture the extent of the damage.

In addition to these detailed evaluations, inspectors assign federal ratings based on the overall average condition of a bridge’s major components. These federal ratings correspond to the values of the **Condition** variable used in our paper and analysis. Bridges with condition scores below 5 are classified as being in “poor” condition and are further categorized as either Structurally Deficient (SD) or Functionally Obsolete (FO). All findings from these assessments are recorded in inspection reports, providing essential data to guide maintenance, rehabilitation, or replacement efforts.[@measurement]

## Outcome Variable
### Condition 
The **Condition** variable reflects the overall state of a bridge, encompassing both its structural integrity and functional adequacy as determined during inspections. It is measured on a continuous scale from 1 to 7, with higher scores indicating better condition. Bridges with condition scores above 5 are considered to be in good standing, while scores below 5 indicate that a bridge is classified as either Structurally Deficient (SD) or Functionally Obsolete (FO).

```{r}
#| label: tbl-condition-summary
#| tbl-cap: "Summary Statistics of NYS Bridge Condition Ratings"
#| echo: false
#| tbl-pos: "H"

# Summary statistics for Condition
condition_summary <- bridge_data %>%
  summarise(
    Min = round(min(Condition, na.rm = TRUE), 2),
    Max = round(max(Condition, na.rm = TRUE), 2),
    Mean = round(mean(Condition, na.rm = TRUE), 2),
    Median = round(median(Condition, na.rm = TRUE), 2),
    "Standard Deviation" = round(sd(Condition, na.rm = TRUE), 2),
    Count = n()
  )

# Create a table
kable(condition_summary, format = "latex", booktabs = TRUE)
```
@tbl-condition-summary presents for the condition ratings of bridges in New York State, based on a clenaed dataset of 15,855 observations. The mean condition rating of 5.38 indicates that, on average, bridges are in fair to good condition. The median rating of 5.30 suggests that half of the bridges have condition ratings below or equal to 5.30. The close alignment of the mean and median reflects a relatively symmetrical distribution. While the minimum condition rating is 1.93, and the maximum is 7, the standard deviation of 0.83 suggests that most bridges cluster around the mean, with only a few outliers at the extreme ends of the scale. These statistics indicate that the majority of bridges are maintained at a stable and adequate level, with relatively few in very poor or excellent condition.

\newpage

```{r}
#| label: fig-condition-histogram
#| fig-cap: "Distribution of Bridge Condition Ratings"
#| echo: false
#| warning: false
#| message: false
#| Fig-pos: "H"

# Create a histogram for the Condition variable
ggplot(bridge_data, aes(x = Condition)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "black") +
  scale_x_continuous(breaks = seq(1, 7, 1), limits = c(1, 7)) + # Ensures x-axis shows 1 to 7
  labs(
    x = "Bridge Condition Rating",
    y = "Frequency"
  ) +
  theme_minimal()
```


@fig-condition-histogram The histogram displays the distribution of bridge condition ratings in New York State. The majority of bridges are clustered around the middle to upper end of the condition scale, with relatively few bridges at either the lower or higher ends. The left tail, representing bridges in severely poor condition, is thin, indicating that such bridges are uncommon. Similarly, the right tail, corresponding to bridges in excellent condition, is sparse, suggesting that high-quality, newly constructed bridges are not predominant. The distribution highlights a concentration of bridges in moderate condition, with a gradual decrease in frequency toward both ends, reflecting the natural aging process and variability in maintenance practices across the state.

## Predictor variables
### Age of Bridge at Inspection
The **AgeAtInspection** variable is a continuous measure that represents the age of a bridge in years. It is calculated as the time elapsed from the year the bridge was originally built or entirely replaced to its most recent inspection date.

\newpage
```{r}
#| label: fig-age-histogram
#| fig-cap: "Distribution of Bridge Ages at the Time of Inspection. The red dashed lines mark intervals of 25 years and the blue density curve provides a smooth visualization of the distribution"
#| echo: false
#| Fig-pos: "H"
#| warning: false
#| message: false

# Visualization: Histogram with mode markers and density curve
ggplot(bridge_data, aes(x = AgeAtInspection)) +
  geom_histogram(binwidth = 5, fill = "lightblue", color = "black", alpha = 0.7) + # Histogram
  geom_vline(xintercept = seq(25, 150, by = 25), color = "red", linetype = "dashed", size = 0.8) + # Vertical lines for modes
  geom_density(aes(y = ..count..), color = "blue", size = 1) + # Density curve scaled to histogram
  labs(
    x = "Bridge Ages at Inspection (Years)",
    y = "Frequency"
  ) +
  theme_minimal()


```
@fig-age-histogram shows distribution of bridge ages at the time of inspection, overlaid with red dashed lines and a blue density curve. The red dashed lines mark intervals of 25 years and align with clear peaks in the histogram, suggesting periodic patterns in bridge construction or major renovations. Prominent clusters are observed around 25, 50, and 75 years of age, indicating that many bridges were likely built or reconstructed during these timeframes. The blue density curve provides a smooth visualization of the distribution, confirming the periodic modes while highlighting the overall trends. Beyond 100 years, the frequency drops significantly, with very few bridges older than this still in operation, reflecting the typical lifecycle of infrastructure. The concentration of bridges between 20 and 80 years old suggests that a significant portion of bridges are mid-life and may soon require maintenance or replacement.It highlights both the historical patterns of bridge construction and the current age distribution of bridges in the dataset.
```{r}
#| label: fig-ageatinspection-condition
#| fig-cap: "Relationship Between Bridge Age at Inspection and Bridge Condition Rating. Each blue dot represents a bridge, showing its age at the time of inspection and the corresponding condition rating obtained from that inspection."
#| echo: false
#| warning: false
#| message: false
#| fig-pos: "H"

# Visualization: Relationship between AgeAtInspection and Condition
ggplot(bridge_data, aes(x = AgeAtInspection, y = Condition)) +
  geom_point(alpha = 0.3, color = "blue") +
  labs(
    x = "Bridge Age at Inspection (Years)",
    y = "Bridge Condition Rating"
  ) +
  theme_minimal()
```
@fig-ageatinspection-condition illustrates the relationship between bridge age at inspection and their condition ratings. Most points are concentrated in the upper-left quadrant, showing that younger bridges tend to have higher condition ratings (close to 7). As bridge age increases, condition ratings generally decline, reflecting the expected deterioration over time. However, beyond approximately 80 to 100 years, the relationship becomes less defined, with condition ratings displaying a wide range. This variability may be influenced by differences in maintenance practices, varying levels of transportation load, or disparities in construction quality among older bridges. Overall, the pattern indicates that bridge age is a key factor in determining condition, particularly for younger and midlife bridges.

### Bridge Located Municipality
The **Located_Municipality** variable categorizes bridges based on the type of municipality where they are located. The three categories are City, Town, and Village.

```{r}
#| label: tbl-located-municipality-proportion
#| tbl-cap: "Proportion of Bridges by Municipality. The first column lists the type of municipality where the bridges are located, including City, Town, and Village, while the second column shows the proportion of bridges in each category."
#| echo: false
#| tbl-pos: "H"

# Proportion of bridges by municipality
located_municipality_proportion <- bridge_data %>%
  group_by(Located_Municipality) %>%
  summarise(
    "Percentage Account" = paste0(round((n() / nrow(bridge_data)) * 100, 2), "%")
  )

# Rename the first column of the summarize table
colnames(located_municipality_proportion)[
  colnames(located_municipality_proportion) == "Located_Municipality"
] <- "Bridge Located Municipality"

# Create a formatted table
kable(located_municipality_proportion, format = "latex", booktabs = TRUE)
```
@tbl-located-municipality-proportion shows the distribution of bridges across different municipality types. Towns account for the majority of the bridges, representing 82.11% of the dataset, while cities and villages make up much smaller proportions, at 9.15% and 8.75%, respectively. This indicates that most bridges are located in towns, likely due to their larger geographic coverage.
```{r}
#| label: tbl-located-municipality-condition
#| tbl-cap: "Average Bridge Condition Rating by Municipality. The first column lists the type of municipality where the bridges are located, including City, Town, and Village, and the second column provides the average condition rating for bridges in each category."
#| echo: false
#| tbl-pos: "H"

# Average condition by municipality
located_municipality_condition <- bridge_data %>%
  group_by(Located_Municipality) %>%
  summarise(
    "Average Condition Rating" = round(mean(Condition, na.rm = TRUE), 2)
  )
 
# Rename the first column of the summarize table
colnames(located_municipality_condition)[
  colnames(located_municipality_condition) == "Located_Municipality"
] <- "Bridge Located Municipality"

# Create a formatted table
kable(located_municipality_condition, format = "latex", booktabs = TRUE)
```
@tbl-located-municipality-condition presents the average condition ratings of bridges by municipality type. Bridges in towns have the highest average condition rating of 5.41, followed by villages at 5.33 and cities at 5.16. The variation in average condition ratings may reflect differences in maintenance practices, traffic loads, or resource allocation among the municipality types.

### Ownership of Bridge
The **Owner_Group** variable categorizes bridges based on their ownership. This variable is designed to estimate potential differences in bridge conditions that may arise from varying ownership responsibilities. The categories include Municipalities, NYSDOT, and Other. The Other category combines bridges owned by private entities, authorities, commissions, and similar groups, as each accounts for a small portion of the data, making it practical to group them together
```{r}
#| label: tbl-owner-group-proportion
#| tbl-cap: "Proportion of Bridges by Ownership. The first column lists the type of bridge ownership, including NYSDOT, Municipality, and Other (private entities, authorities, commissions), while the second column shows the proportion of bridges in each category."
#| echo: false
#| tbl-pos: "H"

# Proportion of bridges by ownership
owner_group_proportion <- bridge_data %>%
  group_by(Owner_Group) %>%
  summarise(
    "Percentage Account" = paste0(round((n() / nrow(bridge_data)) * 100, 2), "%")
  )

# Rename the first column of the summarize table
colnames(owner_group_proportion)[
  colnames(owner_group_proportion) == "Owner_Group"
] <- "Ownership of Bridge"

# Create a formatted table
kable(owner_group_proportion, format = "latex", booktabs = TRUE)
```
@tbl-owner-group-proportion summarizes the ownership distribution of bridges. The two largest ownership groups are municipalities and NYSDOT, which account for 49.83% and 43.05% of the dataset, respectively. The remaining 7.13% of bridges fall under the "Other" category, which includes private, authority, and commission ownerships. The high percentage of bridges owned by municipalities and NYSDOT reflects their dominant role in managing public infrastructure.


```{r}
#| label: tbl-owner-group-condition
#| tbl-cap: "Average Bridge Condition Rating by Ownership. The first column lists the type of bridge ownership, including NYSDOT, Municipality, and Other (private entities, authorities, commissions), and the second column provides the average condition rating for bridges in each category."
#| echo: false
#| tbl-pos: "H"

# Average condition by ownership
owner_group_condition <- bridge_data %>%
  group_by(Owner_Group) %>%
  summarise(
    "Average Condition Rating" = round(mean(Condition, na.rm = TRUE), 2)
  )

# Rename the first column of the summarize table
colnames(owner_group_condition)[
  colnames(owner_group_condition) == "Owner_Group"
] <- "Ownership of Bridge"

# Create a formatted table
kable(owner_group_condition, format = "latex", booktabs = TRUE)
```
@tbl-owner-group-condition shows the average condition ratings of bridges grouped by ownership. Bridges owned by municipalities have the highest average condition rating of 5.45, while NYSDOT-owned bridges have a slightly lower rating of 5.33. Bridges in the "Other" ownership category have the lowest average condition rating of 5.10, which may reflect less consistent maintenance or differing priorities among private or non-government entities.

# Model

The goal of our modeling strategy is to investigate the relationship between bridge condition ratings and key predictors, including **AgeAtInspection**, **Located_Municipality**, and **Owner_Group**. The model aims to identify significant patterns and evaluate how these factors influence bridge conditions. 

Here, we present a linear regression model, explaining its setup, assumptions, and justification. Details of model diagnostics and validation can be found in [Appendix -@sec-model-details].

## Model Setup

Define $y_i$ as the condition rating of bridge $i$, measured on a scale from 1 to 7, where higher values represent better condition. The predictors are defined as follows:
- $x_{1i}$: Age of bridge $i$ at the time of inspection (**AgeAtInspection**), measured in years.
- $x_{2i}$: Type of municipality where the bridge is located (**Located_Municipality**), categorized as **City**, **Town**, or **Village**.
- $x_{3i}$: Type of ownership of bridge $i$ (**Owner_Group**), categorized as **Municipality**, **NYSDOT**, or **Other**.

The linear regression model is expressed as:
```{=latex}
\[
\begin{aligned}
y_i &= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i, \text{City}} + \beta_3 x_{2i, \text{Village}} \\
&\quad + \beta_4 x_{3i, \text{NYSDOT}} + \beta_5 x_{3i, \text{Other}} + \epsilon_i, \\
\epsilon_i &\sim \text{Normal}(0, \sigma^2),
\end{aligned}
\]

```

The model assumes that the relationship between predictors and the response variable is linear, and that the residuals are normally distributed with constant variance.

### Software Implementation

We implemented the model in R using the `lm()` function, which fits a linear regression model using ordinary least squares. Model validation and diagnostics, including residual analysis and goodness-of-fit metrics, were conducted to assess model performance.

## Model Justification

The inclusion of **AgeAtInspection** as a continuous predictor reflects its importance in capturing the natural deterioration of bridges over time. **Located_Municipality** and **Owner_Group** were included as categorical predictors to account for variations in maintenance practices, funding, and infrastructure quality that differ across municipalities and ownership types. These variables align directly with those defined in the data section, ensuring consistency between the data description and modeling approach.

We chose a linear regression model for its simplicity, interpretability, and appropriateness for the continuous response variable (**Condition**). While other models, such as generalized additive models or Bayesian regressions, could capture non-linearities or incorporate priors, the current dataset supports a linear approach without overcomplicating the analysis.

### Assumptions and Limitations

The model assumes:
- A linear relationship between predictors and the response variable.
- Homoscedasticity (constant variance of residuals).
- Normality of residuals.
- Independence of observations.

Potential limitations include the exclusion of interaction terms and other factors (e.g., traffic volume, environmental conditions) that could influence bridge condition. Furthermore, the linear regression model may not capture complex non-linear relationships or spatial dependencies inherent in the data.

### Validation and Diagnostics

To validate the model, we performed:
- **Residual Analysis**: Checked for patterns in residuals to confirm assumptions of linearity and homoscedasticity.
- **Goodness-of-Fit Metrics**: Calculated $R^2$ and adjusted $R^2$ to evaluate how well the model explains variability in the data.
- **Sensitivity Analysis**: Assessed the impact of excluding extreme outliers on the estimated coefficients.
- **Alternative Models**: Considered models with interaction terms and different transformations of predictors but found no substantial improvement in model performance.

Details of model diagnostics, including plots of residuals and additional goodness-of-fit metrics, are provided in [Appendix -@sec-model-details].

# Results



# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]

```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-stanareyouokay
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 2

```



\newpage


# References


